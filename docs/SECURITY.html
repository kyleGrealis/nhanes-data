<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Security Policy • nhanesdata</title><script src="lightswitch.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Security Policy"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">nhanesdata</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/getting-started.html">Getting Started with NHANES Data</a></li>
    <li><a class="dropdown-item" href="articles/introduction.html">Introduction to nhanesdata</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kyleGrealis/nhanesdata" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Security Policy</h1>

    </div>

<div id="security-policy" class="section level1">

<div class="section level2">
<h2 id="cloudflare-r2-setup--access-control">Cloudflare R2 Setup &amp; Access Control<a class="anchor" aria-label="anchor" href="#cloudflare-r2-setup--access-control"></a></h2>
<p>This project uses Cloudflare R2 (S3-compatible object storage) to host NHANES datasets publicly. The security model follows industry best practices for open data distribution.</p>
<div class="section level3">
<h3 id="access-model">Access Model<a class="anchor" aria-label="anchor" href="#access-model"></a></h3>
<div class="section level4">
<h4 id="public-read-access-users">Public Read Access (Users)<a class="anchor" aria-label="anchor" href="#public-read-access-users"></a></h4>
<ul><li>
<strong>Who:</strong> Anyone on the internet</li>
<li>
<strong>Access:</strong> HTTPS GET requests to <code>https://nhanes.kylegrealis.com/</code>
</li>
<li>
<strong>Authentication:</strong> None required</li>
<li>
<strong>Purpose:</strong> Allow researchers to freely download NHANES datasets</li>
<li>
<strong>Operations:</strong> Read-only (download <code>.parquet</code> files)</li>
</ul></div>
<div class="section level4">
<h4 id="private-write-access-maintainers">Private Write Access (Maintainers)<a class="anchor" aria-label="anchor" href="#private-write-access-maintainers"></a></h4>
<ul><li>
<strong>Who:</strong> Package maintainer + GitHub Actions workflow</li>
<li>
<strong>Access:</strong> S3-compatible API with scoped credentials</li>
<li>
<strong>Authentication:</strong> R2 API token (stored in GitHub Secrets)</li>
<li>
<strong>Purpose:</strong> Upload updated datasets from CDC servers</li>
<li>
<strong>Operations:</strong> Write, update, delete (limited to <code>nhanes-data</code> bucket)</li>
</ul></div>
</div>
<div class="section level3">
<h3 id="setting-up-r2-credentials">Setting Up R2 Credentials<a class="anchor" aria-label="anchor" href="#setting-up-r2-credentials"></a></h3>
<div class="section level4">
<h4 id="step-1-create-scoped-r2-api-token">Step 1: Create Scoped R2 API Token<a class="anchor" aria-label="anchor" href="#step-1-create-scoped-r2-api-token"></a></h4>
<ol style="list-style-type: decimal"><li>Log in to your <a href="https://dash.cloudflare.com/" class="external-link">Cloudflare Dashboard</a>
</li>
<li>Navigate to <strong>R2</strong> → <strong>Overview</strong>
</li>
<li>Click <strong>Manage R2 API Tokens</strong>
</li>
<li>Click <strong>Create API Token</strong>
</li>
<li>Configure the token:
<ul><li>
<strong>Token name:</strong> <code>nhanes-data-workflow</code>
</li>
<li>
<strong>Permissions:</strong> Object Read &amp; Write</li>
<li>
<strong>TTL:</strong> 1 year (set calendar reminder to rotate)</li>
<li>
<strong>Bucket scope:</strong> <code>nhanes-data</code> (specific bucket only)</li>
<li>
<strong>IP restrictions:</strong> Optional (GitHub Actions IPs change, generally leave empty)</li>
</ul></li>
<li>Click <strong>Create API Token</strong>
</li>
<li>
<strong>CRITICAL:</strong> Copy the following values immediately (they won’t be shown again):
<ul><li>Access Key ID</li>
<li>Secret Access Key</li>
<li>Account ID (also visible in R2 dashboard URL)</li>
</ul></li>
</ol></div>
<div class="section level4">
<h4 id="step-2-add-credentials-to-github-secrets">Step 2: Add Credentials to GitHub Secrets<a class="anchor" aria-label="anchor" href="#step-2-add-credentials-to-github-secrets"></a></h4>
<ol style="list-style-type: decimal"><li>Go to your GitHub repository</li>
<li>Navigate to <strong>Settings</strong> → <strong>Secrets and variables</strong> → <strong>Actions</strong>
</li>
<li>Click <strong>New repository secret</strong> and add each of the following:</li>
</ol><table class="table"><colgroup><col width="46%"><col width="26%"><col width="26%"></colgroup><thead><tr><th>Secret Name</th>
<th>Value</th>
<th>Notes</th>
</tr></thead><tbody><tr><td><code>R2_ACCOUNT_ID</code></td>
<td>Your Cloudflare Account ID</td>
<td>Visible in dashboard URL</td>
</tr><tr><td><code>R2_ACCESS_KEY_ID</code></td>
<td>Access Key ID from Step 1</td>
<td>Starts with long alphanumeric string</td>
</tr><tr><td><code>R2_SECRET_ACCESS_KEY</code></td>
<td>Secret Access Key from Step 1</td>
<td>Long random string - NEVER commit to git</td>
</tr></tbody></table><ol start="4" style="list-style-type: decimal"><li>Verify all three secrets are listed in the repository secrets page</li>
</ol></div>
<div class="section level4">
<h4 id="step-3-test-locally-optional">Step 3: Test Locally (Optional)<a class="anchor" aria-label="anchor" href="#step-3-test-locally-optional"></a></h4>
<p>To test R2 upload locally before pushing to GitHub:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set environment variables (DO NOT commit these!)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>R2_ACCOUNT_ID <span class="op">=</span> <span class="st">"your_account_id"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>R2_ACCESS_KEY_ID <span class="op">=</span> <span class="st">"your_access_key_id"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>R2_SECRET_ACCESS_KEY <span class="op">=</span> <span class="st">"your_secret_access_key"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Test upload</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">nhanesdata</span><span class="op">)</span></span>
<span><span class="va">demo</span> <span class="op">&lt;-</span> <span class="fu">pull_nhanes</span><span class="op">(</span><span class="st">'demo'</span><span class="op">)</span></span>
<span><span class="fu">nhanes_pin_write</span><span class="op">(</span><span class="va">demo</span>, <span class="st">'demo'</span>, <span class="st">'nhanes-data'</span><span class="op">)</span></span></code></pre></div>
<p><strong>Important:</strong> Never commit <code>.Renviron</code> or <code>.env</code> files containing these credentials to git!</p>
</div>
</div>
<div class="section level3">
<h3 id="security-best-practices">Security Best Practices<a class="anchor" aria-label="anchor" href="#security-best-practices"></a></h3>
<div class="section level4">
<h4 id="token-management">Token Management<a class="anchor" aria-label="anchor" href="#token-management"></a></h4>
<ul><li>✅ <strong>DO:</strong> Use scoped tokens limited to specific buckets</li>
<li>✅ <strong>DO:</strong> Rotate tokens at least annually</li>
<li>✅ <strong>DO:</strong> Set calendar reminders for token expiration</li>
<li>✅ <strong>DO:</strong> Revoke tokens immediately if compromised</li>
<li>❌ <strong>DON’T:</strong> Use account-level admin tokens</li>
<li>❌ <strong>DON’T:</strong> Share tokens across multiple projects</li>
<li>❌ <strong>DON’T:</strong> Commit tokens to git (add to <code>.gitignore</code>)</li>
</ul></div>
<div class="section level4">
<h4 id="github-actions-security">GitHub Actions Security<a class="anchor" aria-label="anchor" href="#github-actions-security"></a></h4>
<ul><li>✅ <strong>DO:</strong> Pin action versions (e.g., <code>actions/checkout@v4</code>)</li>
<li>✅ <strong>DO:</strong> Use minimal permissions in workflow <code>permissions:</code> block</li>
<li>✅ <strong>DO:</strong> Enable branch protection on <code>main</code> branch</li>
<li>✅ <strong>DO:</strong> Require PR reviews before merging</li>
<li>❌ <strong>DON’T:</strong> Use <code>permissions: write-all</code>
</li>
<li>❌ <strong>DON’T:</strong> Disable required status checks</li>
</ul></div>
<div class="section level4">
<h4 id="r2-bucket-configuration">R2 Bucket Configuration<a class="anchor" aria-label="anchor" href="#r2-bucket-configuration"></a></h4>
<ul><li>✅ <strong>DO:</strong> Enable public read access via custom domain</li>
<li>✅ <strong>DO:</strong> Review bucket access logs periodically</li>
<li>✅ <strong>DO:</strong> Enable versioning (pins handles this automatically)</li>
<li>✅ <strong>DO:</strong> Set lifecycle policies if storage costs become a concern</li>
<li>❌ <strong>DON’T:</strong> Grant public write access</li>
<li>❌ <strong>DON’T:</strong> Disable access logging</li>
</ul></div>
</div>
<div class="section level3">
<h3 id="what-if-credentials-are-compromised">What If Credentials Are Compromised?<a class="anchor" aria-label="anchor" href="#what-if-credentials-are-compromised"></a></h3>
<p>If you suspect R2 credentials have been exposed:</p>
<ol style="list-style-type: decimal"><li>
<p><strong>Immediately revoke the token</strong> in Cloudflare dashboard</p>
<ul><li>R2 → Manage R2 API Tokens → Find token → Delete</li>
</ul></li>
<li><p><strong>Create a new scoped token</strong> (follow Step 1 above)</p></li>
<li><p><strong>Update GitHub Secrets</strong> with new credentials</p></li>
<li>
<p><strong>Review R2 bucket access logs</strong></p>
<ul><li>Check for unauthorized uploads/deletions</li>
<li>Cloudflare dashboard → R2 → Analytics</li>
</ul></li>
<li>
<p><strong>Verify data integrity</strong></p>
<ul><li>Run workflow manually to re-upload all datasets</li>
<li>Check checksums in <code>.checksums.json</code>
</li>
</ul></li>
<li>
<p><strong>Consider additional measures:</strong></p>
<ul><li>Enable Cloudflare Access policies</li>
<li>Add IP restrictions to new token (if feasible)</li>
<li>Investigate how credentials were exposed</li>
</ul></li>
</ol></div>
<div class="section level3">
<h3 id="security-model-justification">Security Model Justification<a class="anchor" aria-label="anchor" href="#security-model-justification"></a></h3>
<p>This project uses <strong>public read / private write</strong> because:</p>
<ol style="list-style-type: decimal"><li>
<strong>Data is inherently public</strong> - NHANES data is publicly available from CDC</li>
<li>
<strong>Open science</strong> - Facilitates reproducible research</li>
<li>
<strong>Industry standard</strong> - Same model as CRAN, Bioconductor, AWS Open Data</li>
<li>
<strong>Limited risk</strong> - R2 token has no billing/account management permissions</li>
<li>
<strong>Auditable</strong> - All access logged by Cloudflare</li>
<li>
<strong>Cost-effective</strong> - No need for authentication infrastructure</li>
</ol></div>
<div class="section level3">
<h3 id="reporting-security-issues">Reporting Security Issues<a class="anchor" aria-label="anchor" href="#reporting-security-issues"></a></h3>
<p>If you discover a security vulnerability in this project:</p>
<ol style="list-style-type: decimal"><li>
<strong>DO NOT</strong> open a public GitHub issue</li>
<li>Email the maintainer directly (see <code>DESCRIPTION</code> file for contact)</li>
<li>Include:
<ul><li>Description of vulnerability</li>
<li>Steps to reproduce</li>
<li>Potential impact</li>
<li>Suggested fix (if known)</li>
</ul></li>
</ol><p>I will respond within 48 hours and work with you to resolve the issue before public disclosure.</p>
</div>
<div class="section level3">
<h3 id="compliance--privacy">Compliance &amp; Privacy<a class="anchor" aria-label="anchor" href="#compliance--privacy"></a></h3>
<ul><li>
<strong>HIPAA:</strong> NHANES data is de-identified and publicly released by CDC. No PHI is stored in this project.</li>
<li>
<strong>GDPR:</strong> No personal data collected or stored by this infrastructure.</li>
<li>
<strong>Data Ownership:</strong> All data sourced from CDC public repositories under their usage terms.</li>
</ul></div>
<div class="section level3">
<h3 id="questions">Questions?<a class="anchor" aria-label="anchor" href="#questions"></a></h3>
<p>For questions about security configuration, open a GitHub Discussion or contact the maintainer.</p>
<hr><p><strong>Last Updated:</strong> 2025-01-16 <strong>Next Review:</strong> 2026-01-16</p>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://kylegrealis.com" class="external-link">Kyle Grealis</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

